<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>小金学汉字</title>
        <link rel="stylesheet" href="https://at.alicdn.com/t/c/font_5023613_zzqj6yvqem.css">
        <link rel="stylesheet" href="css/home.css?v2">
        <script src="res/hanzi.js?v2"></script>
    </head>
    <body>
        <script type="module">
            import { createApp } from './petite-vue.es.js'
            createApp({
                list: [],
                current: {},
                categoryShow: false,
                mounted() {
                    console.log(hanzi);

                    this.list = hanzi.map(item => {
                        item.words = item.words.split('');
                        return item;
                    });
                    console.log(this.list);
                    
                    let category = localStorage.getItem('category');
                    if (category) {
                        this.current = this.list.find(item => item.label === category);
                    }else{
                        this.current = this.list[0];
                    }
                },
                goWriter(word) {
                    window.location.href = `writer.html?word=${word}`;
                },
                changeCategory(item) {
                    this.current = item;
                    localStorage.setItem('category', item.label);
                    this.toggleCategory();
                },
                toggleCategory() {
                    this.categoryShow = !this.categoryShow;
                    if (this.categoryShow) {
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = 'auto';
                    }
                },
            }).mount()
        </script>
        <div v-scope v-cloak @vue:mounted="mounted" class="wrap">
            <div class="category-wrap" :class="{ 'show': categoryShow }" @click="toggleCategory">
                <div class="category" @click.stop="toggleCategory">
                    {{ current.label }}({{ current.count }})
                    <i class="iconfont icon-arrow"></i>
                </div>
                <div class="category-list">
                    <div class="category-item"
                        v-for="item in list"
                        :key="item.label"
                        :class="{ 'active': current.label === item.label }"
                        @click.stop="changeCategory(item)"
                    >
                        {{ item.label }}({{ item.count }})
                        <i class="iconfont icon-check"></i>
                    </div>
                </div>
            </div>
            
            <div class="list">
                <div class="item"
                    v-for="item in current.words"
                    :key="item"
                    @click="goWriter(item)"
                >
                    <div class="txt">{{ item }}</div>
                </div>
            </div>
        </div>
    </body>
</html>